"use strict";const e=require("../../common/vendor.js"),r={data(){return{loading:!1,yuyueClass:"yuyue-box1",yuyueInfo:{peopleNumber:"",userName:"",userPhone:"",datetimesingle:""},today:""}},onLoad(){this.setToday()},onReady(){},methods:{setToday(){const o=new Date,i=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0"),t=String(o.getHours()).padStart(2,"0"),n=String(o.getMinutes()).padStart(2,"0");this.today=`${i}-${u}-${a} ${t}:${n}`},clike(){console.log(this.yuyueClass),this.loading=!0,setTimeout(()=>{this.loading=!1,this.yuyueClass="yuyue-box"},2e3)},handleChange(o){console.log("日期"+o)},yuyueSure(o){console.log(this.yuyueInfo);const i=new Date(this.yuyueInfo.datetimesingle).getTime(),u=new Date().getTime(),a=u+7*24*60*60*1e3;this.yuyueInfo.datetimesingle==""?e.index.showToast({title:"请选择日期",icon:"error"}):this.yuyueInfo.userPhone==""?e.index.showToast({title:"请输入电话",icon:"error"}):this.yuyueInfo.userName==""?e.index.showToast({title:"请输入姓名",icon:"error"}):this.yuyueInfo.userName.length>10?e.index.showToast({title:"请输入正确的昵称",icon:"error"}):this.yuyueInfo.peopleNumber==""?e.index.showToast({title:"请选择人数",icon:"error"}):this.yuyueInfo.userPhone.length<11?e.index.showToast({title:"请输入正确的电话号码",icon:"none"}):i<u?e.index.showToast({title:"选择有误",icon:"none"}):i>a?e.index.showToast({title:"请选择7天内的日期",icon:"none"}):e.index.request({url:"http://127.0.0.1:9999/book/add",method:"POST",data:{bookNumber:this.yuyueInfo.peopleNumber,bookDate:this.yuyueInfo.datetimesingle,bookName:this.yuyueInfo.userName,bookPhone:this.yuyueInfo.userPhone},success:t=>{t.data.code==2e4?e.index.showToast({title:"预约成功",icon:"success"}):e.index.showToast({title:"网络请求失败",icon:"loading"})},fail:t=>{e.index.showToast({title:"网络请求失败",icon:"loading"})}}),this.yuyueInfo={peopleNumber:"",userName:"",userPhone:"",datetimesingle:""},this.yuyueClass="yuyue-box1"},yuyueCancel(){this.yuyueInfo={peopleNumber:"",userName:"",userPhone:"",datetimesingle:""},this.yuyueClass="yuyue-box1"},getUserProfile(){console.log("未登录"),e.wx$1.login({success:o=>{console.log(o.code+"111111111");let a="https://api.weixin.qq.com/sns/jscode2session?appid="+"wx33475484a15eed9b"+"&secret="+"8fae391a617824d3a03493c83ee1abe5"+"&js_code="+o.code+"&grant_type=authorization_code";e.index.request({url:a,method:"GET",success:t=>{console.log(t.data.openid)}})}}),e.wx$1.getUserProfile({desc:"测试",success:o=>{console.log("进来了"),console.log(o),console.log(o.userInfo.nickName),console.log(o.userInfo.avatarUrl),getApp().globalData.userName=o.userInfo.nickName,getApp().globalData.userImage=o.userInfo.avatarUrl,this.clike()},fail:o=>{console.log(o),e.wx$1.showToast({title:"拒绝授权",icon:"error",duration:2e3})}})}}};Array||e.resolveComponent("uni-datetime-picker")();const l=()=>"../../uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker.js";Math||l();function c(o,i,u,a,t,n){return{a:e.o((...s)=>n.getUserProfile&&n.getUserProfile(...s)),b:t.yuyueInfo.peopleNumber,c:e.o(s=>t.yuyueInfo.peopleNumber=s.detail.value),d:e.o(n.handleChange),e:e.o(s=>t.yuyueInfo.datetimesingle=s),f:e.p({type:"datetime","clear-icon":!1,start:t.today,modelValue:t.yuyueInfo.datetimesingle}),g:t.yuyueInfo.userName,h:e.o(s=>t.yuyueInfo.userName=s.detail.value),i:t.yuyueInfo.userPhone,j:e.o(s=>t.yuyueInfo.userPhone=s.detail.value),k:e.o((...s)=>n.yuyueCancel&&n.yuyueCancel(...s)),l:e.o((...s)=>n.yuyueSure&&n.yuyueSure(...s)),m:e.n(t.yuyueClass)}}const y=e._export_sfc(r,[["render",c],["__file","C:/E/h/total/SummerPockets/uniapp-consumer-ui/pages/index/index.vue"]]);wx.createPage(y);
